<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Completeness, Ancillarity, and Basu’s Theorem</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-B8G2041HSB"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-B8G2041HSB', { 'anonymize_ip': true});
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../assets/styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      Stat 210a
      </li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../assets/stat_bear.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Stat 210a</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/berkeley-stat210a/fall-2024" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home / Schedule</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Course Logistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../faq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frequently Asked Questions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../calendar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calendar</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../handwritten-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Handwritten notes</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Course Reader</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reader/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reader/measure-theory-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Measure Theory Basics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">License</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#completeness" id="toc-completeness" class="nav-link active" data-scroll-target="#completeness"><span class="header-section-number">1</span> Completeness</a>
  <ul class="collapse">
  <li><a href="#definition-of-completeness" id="toc-definition-of-completeness" class="nav-link" data-scroll-target="#definition-of-completeness"><span class="header-section-number">1.1</span> Definition of completeness</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="header-section-number">1.2</span> Examples</a></li>
  <li><a href="#full-rank-exponential-families" id="toc-full-rank-exponential-families" class="nav-link" data-scroll-target="#full-rank-exponential-families"><span class="header-section-number">1.3</span> Full-rank exponential families</a></li>
  <li><a href="#complete-sufficient-statistics-are-minimal" id="toc-complete-sufficient-statistics-are-minimal" class="nav-link" data-scroll-target="#complete-sufficient-statistics-are-minimal"><span class="header-section-number">1.4</span> Complete sufficient statistics are minimal</a></li>
  </ul></li>
  <li><a href="#ancillarity" id="toc-ancillarity" class="nav-link" data-scroll-target="#ancillarity"><span class="header-section-number">2</span> Ancillarity</a></li>
  <li><a href="#basus-theorem" id="toc-basus-theorem" class="nav-link" data-scroll-target="#basus-theorem"><span class="header-section-number">3</span> Basu’s Theorem</a>
  <ul class="collapse">
  <li><a href="#using-basus-theorem" id="toc-using-basus-theorem" class="nav-link" data-scroll-target="#using-basus-theorem"><span class="header-section-number">3.1</span> Using Basu’s Theorem</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Completeness, Ancillarity, and Basu’s Theorem</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><span class="math display">\[
\newcommand{\cB}{\mathcal{B}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cN}{\mathcal{N}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\cX}{\mathcal{X}}
\newcommand{\EE}{\mathbb{E}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\td}{\,\textrm{d}}
\newcommand{\simiid}{\stackrel{\textrm{i.i.d.}}{\sim}}
\newcommand{\eqas}{\stackrel{\textrm{a.s.}}{=}}
\newcommand{\eqPas}{\stackrel{\cP\textrm{-a.s.}}{=}}
\newcommand{\eqmuas}{\stackrel{\mu\textrm{-a.s.}}{=}}
\newcommand{\eqD}{\stackrel{D}{=}}
\newcommand{\indep}{\perp\!\!\!\!\perp}
\DeclareMathOperator*{\minz}{minimize\;}
\newcommand{\Var}{\textnormal{Var}}
\newcommand{\Cov}{\textnormal{Cov}}
\newcommand{\Corr}{\textnormal{Corr}}
\]</span></p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Under construction
</div>
</div>
<div class="callout-body-container callout-body">
<p>Check that Laplace median problem is on HW 2 or other, check that minimality for uniform scale is in previous lecture.</p>
</div>
</div>
<section id="completeness" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="completeness"><span class="header-section-number">1</span> Completeness</h2>
<p>As we have seen, for a given statistical problem we may have many different sufficient statistics, some of which reduce the data more than others. We usually want to look for one that is <em>minimal sufficient</em>, meaning that it strips away as much irrelevant information as possible and only retains the information that is relevant to estimating the parameter.</p>
<p>In some cases the minimal sufficient statistic has an additional property called <em>completeness</em>. The definition of completeness is initially counterintuitive, but it has a number of useful implications we will explore throughout the semester.</p>
<section id="definition-of-completeness" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="definition-of-completeness"><span class="header-section-number">1.1</span> Definition of completeness</h3>
<p>A statistic <span class="math inline">\(T(X)\)</span> is complete for a family of distributions <span class="math inline">\(\cP = \{P_\theta: \theta \in \Theta\}\)</span> if no nontrivial function of <span class="math inline">\(T\)</span> can have expectation zero for every distribution in the family:</p>
<p><span class="math display">\[\EE_\theta \,f(T(X)) = 0 \quad \forall \theta \in \Theta \implies f(T) \eqPas 0\]</span> ::: callout-note The name for complete statistics comes from a prior notion that <span class="math inline">\(\cP^T = \{P_\theta^T:\; \theta \in \Theta\}\)</span> is ``complete’’ as a model if its linear span includes all possible distributions on <span class="math inline">\(T(X)\)</span>; see Homework 3. :::</p>
<p>If <span class="math inline">\(X\)</span> itself is complete, then the definition immediately implies that there can be at most one unbiased estimator for any estimand: if <span class="math inline">\(\EE_\theta \delta_1(X) = \EE_\theta \delta_2(X) = g(\theta)\)</span> for all <span class="math inline">\(\theta \in \Theta\)</span>, then <span class="math inline">\(f(X) = \delta_1(X) - \delta_2(X) = 0\)</span> almost surely. More generally, if <span class="math inline">\(T(X)\)</span> is a complete statistic then there can be at most one unbiased estimator that runs through <span class="math inline">\(T\)</span>. We will return to this fact when we discuss unbiased estimation.</p>
<p>We will be especially interested in statistics that are both complete and sufficient. If <span class="math inline">\(T(X)\)</span> is complete and sufficient we call it a <em>complete sufficient statistic</em>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>A complete statistic need not be sufficient: the constant “statistic” <span class="math inline">\(T(X) \equiv 0\)</span> is complete in any model. In general, to show that <span class="math inline">\(T(X)\)</span> is complete sufficient we must establish both properties.</p>
</div>
</div>
</section>
<section id="examples" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="examples"><span class="header-section-number">1.2</span> Examples</h3>
<p><strong>Example 1 (Laplace location family)</strong>: Let <span class="math inline">\(X_1,\ldots,X_n \simiid \text{Lap}(\theta)\)</span> for <span class="math inline">\(\theta \in \RR\)</span>, and recall that the vector of order statistics <span class="math inline">\(S(X) = (X_{(1)},\ldots,X_{(n)})\)</span> is a minimal sufficient statistic. Is <span class="math inline">\(S(X)\)</span> complete?</p>
<div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Expand to see answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>No, <span class="math inline">\(S(X)\)</span> is not complete.</strong></p>
<p>Both the sample median <span class="math inline">\(\text{Med}(S)\)</span> (as defined in Homework 2 Problem XX) and sample mean <span class="math inline">\(\overline{X}(S)\)</span> can be calculated using <span class="math inline">\(S(X)\)</span> alone, and both are unbiased estimators for <span class="math inline">\(\theta\)</span>. Hence <span class="math inline">\(f(S) = \text{Med}(S) - \overline{X}(S)\)</span> has expectation zero, but is not almost surely equal to zero because the median and mean are not equal to each other.</p>
</div>
</div>
</div>
<p><strong>Example 1 (Uniform scale family)</strong>: Let <span class="math inline">\(X_1, \ldots, X_n \simiid U[0, \theta]\)</span>, for <span class="math inline">\(\theta &gt; 0\)</span>. We showed previously that the maximum <span class="math inline">\(T(X) = X_{(n)}\)</span> is minimal sufficient. Is it complete?</p>
<div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Expand to see answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Yes, <span class="math inline">\(T(X)\)</span> is complete.</strong></p>
<p>As we showed previously, the density of <span class="math inline">\(T(X)\)</span> for <span class="math inline">\(t &gt; 0\)</span> is <span class="math display">\[
p_\theta(t) =  \frac{nt^{n-1}}{\theta^n}\,\cdot \;1\{t \leq \theta\}.
\]</span></p>
<p>Suppose we could find <span class="math inline">\(f(t)\)</span> such that <span class="math display">\[
0 = \EE_\theta f(T) = \frac{n}{\theta^n}\int_0^\theta f(t) t^{n-1} \,dt, \quad \text{ for all } \theta &gt; 0.
\]</span> Dividing the last expression by <span class="math inline">\(n/\theta^n\)</span> and then differentiating with respect to <span class="math inline">\(\theta\)</span>, we obtain <span class="math display">\[
0 = f(\theta) \theta^{n-1}, \quad \text{ for all } \theta &gt; 0,
\]</span> hence <span class="math inline">\(f \equiv 0\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="full-rank-exponential-families" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="full-rank-exponential-families"><span class="header-section-number">1.3</span> Full-rank exponential families</h3>
<p>In the general case where <span class="math inline">\(T(X)\)</span> can take on infinitely many values, it is hard to show completeness because the space of possible counterexample functions <span class="math inline">\(f\)</span> is infinite-dimensional. But there is an important class of examples where we can quickly verify complete sufficiency, as we see next.</p>
<p><strong>Definition:</strong> Let <span class="math inline">\(\cP = \{P_\eta:\; \eta \in \Xi\}\)</span> be an <span class="math inline">\(s\)</span>-parameter exponential family with densities <span class="math display">\[
p_\eta(x) = e^{\eta'T(x) - A(\eta)} h(x),
\]</span> with respect to some carrier measure <span class="math inline">\(\mu\)</span>. Assume further that the sufficient statistic <span class="math inline">\(T(X)\)</span> satisfies no affine constraint: that is, there is no <span class="math inline">\(\alpha \in \RR\)</span> and nonzero <span class="math inline">\(\beta \in \RR^s\)</span> with <span class="math inline">\(\beta'T(x) \eqPas \alpha\)</span>.</p>
<p>If <span class="math inline">\(\Xi\)</span> contains an open set we say <span class="math inline">\(\cP\)</span> is <em>full-rank</em>; otherwise we say it is <em>curved</em>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\(T(X)\)</span> does satisfy a linear constraint, that means <span class="math inline">\(\cP\)</span> can be defined equivalently as an <span class="math inline">\(r\)</span>-parameter exponential family for some <span class="math inline">\(r &lt; s\)</span>. It may be full-rank or curved depending on the parameter space in a lower-dimensional parameterization.</p>
</div>
</div>
<p><strong>Theorem (Complete sufficiency in full-rank exponential families):</strong> If <span class="math inline">\(\cP\)</span> is a full-rank <span class="math inline">\(s\)</span>-parameter exponential family, then <span class="math inline">\(T(X)\)</span> is complete sufficient.</p>
<p>The proof is somewhat technical and uses the uniqueness of moment-generating functions.</p>
<div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Expand for proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(T(X)\)</span> is sufficient by the factorization theorem, so it remains only to prove completeness.</p>
<p>Assume without loss of generality that <span class="math inline">\(0\)</span> is in the interior of <span class="math inline">\(\Xi\)</span>; otherwise we can reparameterize. Assume also that <span class="math inline">\(\cP\)</span> is in canonical form, i.e.&nbsp;<span class="math inline">\(T(X) = X\)</span> and <span class="math inline">\(p_\eta(x) = e^{\eta'x - A(\eta)}\)</span>; in general we can always reduce to this case by making a sufficiency reduction and taking <span class="math inline">\(P_0^T\)</span> as the carrier measure.</p>
<p>Any measurable function <span class="math inline">\(f\)</span> can be decomposed as <span class="math inline">\(f(x) = f^+(x) - f^-(x)\)</span> where <span class="math inline">\(f^+\)</span> and <span class="math inline">\(f^-\)</span> are non-negative measurable functions. If <span class="math inline">\(\EE_\eta f(X) = \int (f^+-f^-)p_\eta \,d\mu = 0\)</span> for all <span class="math inline">\(\eta\in\Xi\)</span>, then we have <span id="eq-mgf-equality"><span class="math display">\[
\int e^{\eta'x} f^+(x) \,d\mu(x) = \int e^{\eta'x} f^-(x) \,d\mu(x), \quad \text{ for all } \eta \in \Xi.
\tag{1}\]</span></span> By assumption, <span class="math inline">\(\Xi\)</span> contains an open neighborhood that includes <span class="math inline">\(0\)</span> on which both integrals are finite. Let <span class="math inline">\(c = \int f^+(x)\,d\mu(x) \geq 0\)</span>.</p>
<p>If <span class="math inline">\(c&gt;0\)</span> then we can define the random variables <span class="math inline">\(Y^+\)</span> and <span class="math inline">\(Y^-\)</span> with probability densities <span class="math inline">\(f^+(x)/c\)</span> and <span class="math inline">\(f^-(x)/c\)</span> respectively; then <a href="#eq-mgf-equality">Equation&nbsp;1</a> implies that <span class="math inline">\(Y^+\)</span> and <span class="math inline">\(Y^-\)</span> have equal MGFs in a neighborhood of <span class="math inline">\(0\)</span>; hence they have the same distribution and their densities must be a.s. equal to each other. But <span class="math inline">\(f^+(x)=f^-(x)\)</span> only when both are zero, so we have <span class="math inline">\(f^+, f^- \eqmuas 0\)</span>.</p>
</div>
</div>
</div>
<p>The next figure shows three cases for exponential families with the same sufficient statistic. The set <span class="math inline">\(\Xi_1\)</span> indicates the full natural parameter space for a generic 2-parameter exponential family, and (A), (B), and (C) denote parameter spaces for three different subfamilies. The subfamily described by the shaded circle (A) is a full-rank exponential family, because it contains an open set. The subfamily described by the curve (B) is a typical example of a curved family, because it does not contain an open set. The subfamily described by the line segment (C) is technically curved according to the definition above, but we could view it as a full-rank <span class="math inline">\(1\)</span>-parameter exponential family after reparameterizing it.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="completeness.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">This figure shows three cases:</figcaption>
</figure>
</div>
</section>
<section id="complete-sufficient-statistics-are-minimal" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="complete-sufficient-statistics-are-minimal"><span class="header-section-number">1.4</span> Complete sufficient statistics are minimal</h3>
<p>A second convenient property of completeness is that complete sufficient statistics are always minimal sufficient.</p>
<p><strong>Theorem:</strong> If <span class="math inline">\(T(X)\)</span> is complete sufficient for the family <span class="math inline">\(\mathcal{P}\)</span>, then <span class="math inline">\(T(X)\)</span> is minimal sufficient for <span class="math inline">\(\cP\)</span>.</p>
<p>The way that we usually use completeness in proofs is to show that two quantities are almost surely equal by showing that they have the same expectation. The next proof is an example.</p>
<p><em>Proof:</em> Let <span class="math inline">\(S(X)\)</span> represent any minimal sufficient statistic, and define the conditional expectation of <span class="math inline">\(T\)</span> given <span class="math inline">\(S\)</span>: <span class="math display">\[
\overline{T}(S(X)) = \EE[T(X) \mid S(X)].
\]</span> Note that this conditional expectation does not depend on the parameter <span class="math inline">\(\theta\)</span>, because <span class="math inline">\(S(X)\)</span> is sufficient, so <span class="math inline">\(\overline{T}\)</span> is a valid statistic. If we can show that <span class="math inline">\(\overline{T} \eqas T(X)\)</span>, that means we can calculate <span class="math inline">\(T(X)\)</span> from <span class="math inline">\(S(X)\)</span>, so <span class="math inline">\(T(X)\)</span> is also minimal sufficient.</p>
<p>Because <span class="math inline">\(S(X)\)</span> is minimal sufficient, we can write it as <span class="math inline">\(f(T(X))\)</span> for some function <span class="math inline">\(f\)</span>, and use <span class="math inline">\(f\)</span> to define a function <span class="math inline">\(g\)</span> giving the difference between <span class="math inline">\(T\)</span> and <span class="math inline">\(\overline{T}\)</span>: <span class="math display">\[
g(t) = t - \overline{T}(f(t)).
\]</span> The expectation of <span class="math inline">\(g(T)\)</span> is always zero, because <span class="math display">\[
\begin{aligned}
\EE_\theta\; g(T(X)) &amp;= \EE_\theta\; T(X) - \EE_\theta\; \overline{T}(S(X)) \\[5pt]
&amp;= \EE_\theta\; T(X) - \EE_\theta\left[\EE[T(X) \mid S(X)]\right]\\
&amp;= 0.
\end{aligned}
\]</span> As a result, <span class="math inline">\(g(T) \eqas 0\)</span> and hence <span class="math inline">\(T \eqas \overline{T}\)</span>, as desired.</p>
</section>
</section>
<section id="ancillarity" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="ancillarity"><span class="header-section-number">2</span> Ancillarity</h2>
<p>We’ve spent a lot of time discussing sufficient statistics, which are statistics that carry <em>all</em> of the information about <span class="math inline">\(\theta\)</span>. Our next definition describes a type of statistic that carry <em>no</em> information about the parameter.</p>
<p><strong>Definition:</strong> We say <span class="math inline">\(V(X)\)</span> is ancillary for the model <span class="math inline">\(\cP = \{P_\theta: \theta \in \Theta\}\)</span> if its distribution does not depend on <span class="math inline">\(\theta\)</span>.</p>
<p>Just as the sufficiency principle tells us that our inference procedures should depend only on information from sufficient statistics, an analogous principle suggests in effect that procedures should depend as little as possible on ancillary statistics. Specifically, it recommends treating <span class="math inline">\(V(X)\)</span> as a fixed value and evaluating the rest of the data set according to its distribution <em>conditional on</em> <span class="math inline">\(V(X)\)</span>:</p>
<p><strong>Conditionality Principle:</strong> If <span class="math inline">\(V(X)\)</span> is ancillary, then all inference should be conditional on <span class="math inline">\(V(X)\)</span>.</p>
<p>It may not be immediately clear why conditioning on <span class="math inline">\(V(X)\)</span> “removes” it from the problem, but we will return to the idea of conditional inference during our unit on hypothesis testing and interval estimation, where it will play an important role.</p>
</section>
<section id="basus-theorem" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="basus-theorem"><span class="header-section-number">3</span> Basu’s Theorem</h2>
<p>Basu’s Theorem gives us a simple way to prove that statistics are independent of one another using the definitions introduced above.</p>
<p><strong>Theorem (Basu):</strong> If <span class="math inline">\(T(X)\)</span> is complete sufficient and <span class="math inline">\(V(X)\)</span> ancillary for the model <span class="math inline">\(\cP\)</span>, then <span class="math inline">\(V(X) \indep T(X)\)</span> for all <span class="math inline">\(\theta \in \Theta\)</span>.</p>
<p>Again, for this proof our strategy will be to show that two quantities are almost surely equal to each other, by showing that they have the same expectation for all <span class="math inline">\(\theta\)</span>.</p>
<p><em>Proof:</em> Define the following two quantities representing the marginal and conditional probabilities that <span class="math inline">\(V\)</span> falls into a generic set <span class="math inline">\(A\)</span>. <span class="math display">\[
\begin{aligned}
p_A &amp;= \PP(V \in A)\\[5pt]
q_A(T(X)) &amp;= \PP(V \in A \mid T(X))
\end{aligned}
\]</span> Note that <span class="math inline">\(p_A\)</span> does not depend on <span class="math inline">\(\theta\)</span> by ancillarity of <span class="math inline">\(V\)</span>, while <span class="math inline">\(q_A\)</span> does not depend on <span class="math inline">\(\theta\)</span> by sufficiency of <span class="math inline">\(T\)</span>.</p>
<p>The expectation of their difference is <span class="math display">\[
\EE_\theta\left[q_A(T) - p_A\right] = p_A - p_A = 0, \quad \text{ for all } \theta.
\]</span> By completeness of <span class="math inline">\(T\)</span>, this implies that <span class="math inline">\(q_A(T) \eqas p_A\)</span>: the conditional probability equals the marginal probability. Hence, for any <span class="math inline">\(B\)</span>, we have <span class="math display">\[
\begin{aligned}
\PP_\theta(V \in A, T \in B) &amp;= \int q_A(t) 1\{t \in B\}\,dP_\theta^T(t)\\
&amp;= \int p_A 1\{t \in B\}\,dP_\theta^T(t)\\
&amp;= \PP_\theta(V \in A) \PP_\theta(T \in B).
\end{aligned}
\]</span></p>
<section id="using-basus-theorem" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="using-basus-theorem"><span class="header-section-number">3.1</span> Using Basu’s Theorem</h3>
<p>Basu’s Theorem can be helpful in proving independence. To use it, remember that the hypotheses of the theorem (sufficiency, completeness, and ancillarity) are all defined with respect to a <em>family</em> <span class="math inline">\(\cP\)</span>. The conclusion, however, is defined with respect to individual <em>distributions</em>. As a result, when we apply the theorem we can often benefit from being a little clever about how to define <span class="math inline">\(\cP\)</span>. The following example should make this clear:</p>
<p><strong>Example (Independence of sample mean and sample variance for Gaussian):</strong> Assume <span class="math inline">\(X_1,\ldots,X_n \simiid \cN(\mu, \sigma^2)\)</span> for <span class="math inline">\(\mu \in \RR\)</span> and <span class="math inline">\(\sigma^2 &gt; 0\)</span>. Define the <em>sample mean</em> and <em>sample variance</em> as <span class="math display">\[
\begin{aligned}
\overline{X} &amp;= \frac{1}{n}\sum_{i=1}^n X_i\\[5pt]
S^2 &amp;= \frac{1}{n-1}\sum_{i=1}^n (X_i - \overline{X})^2
\end{aligned}
\]</span> We would like to show <span class="math inline">\(\overline{X} \indep S^2\)</span>.</p>
<p>Initially the approach of applying Basu’s Theorem appears hopeless because, in the model with <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> unknown, neither of these two statistics is ancillary <em>or</em> sufficient. However, we can nevertheless apply Basu’s Theorem if we are just a bit more clever:</p>
<div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Expand for answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Consider the model <span class="math inline">\(\cP\)</span> with <em>known</em> <span class="math inline">\(\sigma^2 &gt; 0\)</span> and unknown <span class="math inline">\(\mu\in \RR\)</span>. This <span class="math inline">\(\cP\)</span> is a one-parameter full-rank exponential family with complete sufficient statistic <span class="math inline">\(\overline{X}\)</span>. Moreover, <span class="math inline">\(S^2\)</span> is ancillary, since we can write <span class="math display">\[
S^2 = \sum_{i=1}^n (Z_i - \overline{Z})^2, \quad \text{ for } Z_i = X_i - \mu.
\]</span> Because the distribution of <span class="math inline">\(Z_1,\ldots,Z_n \simiid N(0,\sigma^2)\)</span> is known, it follows that the distribution of <span class="math inline">\(S^2\)</span> is known as well (specifically, <span class="math inline">\(S^2/\sigma^2\)</span> is a <span class="math inline">\(\chi^2\)</span> random variable with <span class="math inline">\(n-1\)</span> degrees of freedom). Since <span class="math inline">\(\mu\)</span> is the only unknown parameter, <span class="math inline">\(S^2\)</span> is therefore ancillary in <span class="math inline">\(\cP\)</span>. Applying Basu’s theorem, we have <span class="math inline">\(\overline{X} \indep S^2\)</span> for any <span class="math inline">\(\mu \in \RR\)</span>. But <span class="math inline">\(\sigma^2\)</span> was arbitrary, so we have the result for all <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>.</p>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>